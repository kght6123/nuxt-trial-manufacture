(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{220:function(e,t,n){var content=n(223);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(52).default)("1b7833da",content,!0,{sourceMap:!1})},221:function(e,t,n){var content=n(225);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(52).default)("68598a82",content,!0,{sourceMap:!1})},222:function(e,t,n){"use strict";var o=n(220);n.n(o).a},223:function(e,t,n){(t=n(51)(!1)).push([e.i,"",""]),e.exports=t},224:function(e,t,n){"use strict";var o=n(221);n.n(o).a},225:function(e,t,n){(t=n(51)(!1)).push([e.i,"video[data-v-12e36097]{width:100%;height:16rem;--bg-opacity:1;background-color:#000;background-color:rgba(0,0,0,var(--bg-opacity))}input[data-v-12e36097]{width:100%;display:block}button[data-v-12e36097]{--bg-opacity:1;background-color:#cbd5e0;background-color:rgba(203,213,224,var(--bg-opacity));border-radius:.5rem;padding:1rem;margin:.5rem}canvas[data-v-12e36097]{display:block;margin:1rem auto;width:100%;height:16rem}",""]),e.exports=t},229:function(e,t,n){"use strict";n.r(t);n(71),n(16);var o=n(2),r=(n(17),n(23),n(11),n(40),{data:function(){return{imageWidthMin:0,imageWidthMax:0,imageWidthStep:0,imageWidthValue:0,imageCapture:null,devices:[],supportedConstraints:[]}},computed:{},mounted:function(){var e=this;if(navigator.mediaDevices){var t=navigator.mediaDevices.getSupportedConstraints();Object.keys(t).forEach((function(n){var o=t[n];console.log("constraint: ".concat(n)),o&&e.supportedConstraints.push(n)})),navigator.mediaDevices.enumerateDevices().then((function(t){t.forEach((function(e){console.log("".concat(e.kind," : ").concat(e.label," id = ").concat(e.deviceId))})),e.devices=t})).catch((function(e){console.error("".concat(e.name,":").concat(e.message)),alert("".concat(e.name,":").concat(e.message))})),this.onStart()}else alert("この端末は非対応です。")},methods:{onStart:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,track,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return!1,n={video:{facingMode:"environment",width:{min:640,ideal:4096,max:4096},height:{min:480,ideal:2160,max:2160}},audio:!1},t.next=4,navigator.mediaDevices.getUserMedia(n).catch((function(e){console.error("Argh!",e),alert("mediaStreamが取得できませんでした。撮影設定を見直してください。".concat(e.name,":").concat(e.message))}));case 4:if(o=t.sent,console.log("mediaStream",o,e.$refs),e.$refs.video.srcObject=o,o){t.next=9;break}return t.abrupt("return");case 9:if(ImageCapture){t.next=13;break}return e.$refs.video.onloadedmetadata=function(t){e.$refs.video.play()},alert("ImageCapture APIが使えませんでした"),t.abrupt("return");case 13:return track=o.getVideoTracks()[0],e.imageCapture=new ImageCapture(track),t.next=17,e.imageCapture.getPhotoCapabilities();case 17:return r=t.sent,e.imageWidthMin=r.imageWidth.min,e.imageWidthMax=r.imageWidth.max,e.imageWidthStep=r.imageWidth.step,t.next=23,e.imageCapture.getPhotoSettings();case 23:c=t.sent,e.imageWidthValue=c.imageWidth;case 25:case"end":return t.stop()}}),t)})))()},onTakePhotoButtonClick:function(){var e=this;if(this.imageCapture)this.imageCapture.takePhoto({imageWidth:this.imageWidthValue}).then((function(e){var t=URL.createObjectURL(e),a=document.createElement("a");return document.body.appendChild(a),a.download="shoooot.jpg",a.href=t,a.click(),a.remove(),setTimeout((function(){URL.revokeObjectURL(t)}),1e3),createImageBitmap(e)})).then((function(t){e.drawCanvas(t),console.log("Photo size is ".concat(t.width,"x").concat(t.height))})).catch((function(e){console.error(e),alert("".concat(e.name,":").concat(e.message))}));else{var canvas=this.$refs.canvas;canvas.getContext("2d").drawImage(this.$refs.video,0,0,canvas.width,canvas.height),console.log("video size",this.$refs.video.videoWidth,this.$refs.video.videoHeight)}},onPlay:function(){this.$refs.takePhotoButton.disabled=!1},drawCanvas:function(img){var canvas=this.$refs.canvas;canvas.width=getComputedStyle(canvas).width.replace("px",""),canvas.height=getComputedStyle(canvas).height.replace("px","");var e=Math.min(canvas.width/img.width,canvas.height/img.height),t=(canvas.width-img.width*e)/2,n=(canvas.height-img.height*e)/2;canvas.getContext("2d").clearRect(0,0,canvas.width,canvas.height),canvas.getContext("2d").drawImage(img,0,0,img.width,img.height,t,n,img.width*e,img.height*e)},onStop:function(){this.$refs.video.srcObject&&this.$refs.video.srcObject.getVideoTracks&&this.$refs.video.srcObject.getVideoTracks()[0].stop()},sleep:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t){return setTimeout(t,e)}))}}}),c=(n(224),n(38)),component=Object(c.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"p-4"},[n("h3",{staticClass:"text-4xl block"},[e._v("ImageCapture Web APIのサンプル")]),e._v(" "),n("video",{ref:"video",attrs:{autoplay:""},on:{play:e.onPlay}}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.imageWidthValue,expression:"imageWidthValue"}],attrs:{type:"range",min:e.imageWidthMin,max:e.imageWidthMax,step:e.imageWidthStep},domProps:{value:e.imageWidthValue},on:{__r:function(t){e.imageWidthValue=t.target.value}}}),e._v("\n  Now："+e._s(e.imageWidthValue)),n("br"),e._v("\n  Min："+e._s(e.imageWidthMin)),n("br"),e._v("\n  Max："+e._s(e.imageWidthMax)),n("br"),e._v("\n  Step："+e._s(e.imageWidthStep)),n("br"),e._v(" "),n("button",{ref:"takePhotoButton",attrs:{disabled:""},on:{click:e.onTakePhotoButtonClick}},[e._v("Take Photo")]),e._v(" "),n("button",{on:{click:e.onStart}},[e._v("Start")]),e._v(" "),n("button",{on:{click:e.onStop}},[e._v("Stop")]),e._v(" "),n("canvas",{ref:"canvas"}),e._v(" "),n("h4",{staticClass:"text-3xl block"},[e._v("getSupportedConstraints")]),e._v(" "),n("ul",{staticClass:"mb-4"},e._l(e.supportedConstraints,(function(t){return n("li",{key:t},[n("span",{staticClass:"p-2"},[e._v("\n        ● Constraint："+e._s(t)+"\n      ")])])})),0),e._v(" "),n("h4",{staticClass:"text-3xl block"},[e._v("enumerateDevices")]),e._v(" "),n("ul",{staticClass:"mb-4"},e._l(e.devices,(function(t,i){return n("li",{key:i},[n("span",{staticClass:"p-2"},[e._v("\n      ● DeviceID："+e._s(t.deviceId)),n("br"),e._v("\n      Kind："+e._s(t.kind)),n("br"),e._v("\n      Label："+e._s(t.label)+"\n      ")])])})),0)])}),[],!1,null,"12e36097",null);t.default=component.exports},231:function(e,t,n){"use strict";n.r(t);var o={},r=(n(222),n(38)),component=Object(r.a)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("image-capture")],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{ImageCapture:n(229).default})}}]);